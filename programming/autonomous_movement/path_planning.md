## 路径规划
路径规划的目标是让机器人在当前环境中，从起点安全、高效地移动到目标点，同时避开障碍物。在VEX机器人比赛中，由于环境相对固定，因此不会涉及复杂的实时路径规划，而是人类操作员提前写好移动路线，机器人跟随路线运动即可，并不需要机器人感知环境变化从而做出路径调整。那么这里我们就使用一种简单高效的办法实现路径规划。

***

### 贝塞尔曲线（Bézier Curve）
贝塞尔曲线最初由法国工程师皮埃尔·贝塞尔（Pierre Bézier）于1960年代提出，最初用于汽车车身设计。它是一种参数化曲线，广泛应用于计算机图形学、字体设计、动画、路径规划、机器人轨迹生成等领域。它通过一组控制点来定义平滑曲线，具有直观、易控制、数学性质良好等优点。

![bezier](/attachment/picture/bezier.PNG)

#### 基本概念
1. 控制点
第一个点：起点
最后一个点：终点
中间点：影响曲线形状，但不一定在曲线上

2. 阶数
一阶（线性）：2 个控制点 → 直线段
二阶（二次）：3 个控制点 → 抛物线
三阶（三次）：4 个控制点 → 最常用，S形曲线
n 阶：n+1 个控制点

#### 数学定义
<p>以三次贝塞尔曲线为例，给定 4 个控制点
  <b>P<sub>0</sub></b>、<b>P<sub>1</sub></b>、<b>P<sub>2</sub></b>、<b>P<sub>3</sub></b>，
  三次贝塞尔曲线的参数方程为：
</p>

<p style="text-align:center; font-size:1.2em;">
  <b>B</b>(t) = (1−t)<sup>3</sup><b>P<sub>0</sub></b> +
              3(1−t)<sup>2</sup>t<b>P<sub>1</sub></b> +
              3(1−t)t<sup>2</sup><b>P<sub>2</sub></b> +
              t<sup>3</sup><b>P<sub>3</sub></b>, 
  t ∈ [0, 1]
</p>

<p>该式是伯恩斯坦多项式的线性组合。</p>

#### 几何性质
| 性质        | 描述                                      |
| --------- | --------------------------------------- |
| **端点插值**  | 曲线始终通过起点 $P_0$ 和终点 $P_n$                |
| **切线方向**  | 起点切线方向为 $P_1 - P_0$，终点为 $P_n - P_{n-1}$ |
| **凸包性**   | 曲线完全位于控制点构成的凸包内                         |
| **仿射不变性** | 对控制点进行旋转、平移、缩放，曲线也随之变换                  |
| **平滑性**   | 曲线连续可导，适合轨迹平滑                           |

***

### 离散化曲线
为了方便后续路径追踪的实现，我们其实并不需要计算出一整条曲线，而是得到利用这个曲线计算出来的离散点就可以了。因此需要把一条参数贝塞尔曲线B(t) = Σ_{i=0}^{n} P_i B_{n,i}(t), t∈[0,1]离散化成有序点列 {Q_k}，并保证两点之间距离任意小。这里以二阶贝塞尔曲线为例子。

#### 参数方程
给定 3 个控制点 P₀, P₁, P₂，二阶贝塞尔曲线写成：

B(t) = (1−t)² P₀ + 2(1−t)t P₁ + t² P₂, t∈[0,1]

#### 分量展开
把向量方程按 x、y 分量写出：

B(t) = [Bx(t),  By(t)]ᵀ
Bx(t) = (1−t)² P₀x + 2(1−t)t P₁x + t² P₂x
By(t) = (1−t)² P₀y + 2(1−t)t P₁y + t² P₂y

#### 离散采样
将参数区间 [0,1] 等距分成 k 段，步长：
Δt = 1 / k

采样点：
t_i = i · Δt, i = 0,1,…,k

依次调用 B(t_i) 即可得到离散点集合 {Q_i}，机器人只需要按照这些离散点进行运动即可。

***
#### :door: [回到轮式机器人自主移动](/programming/autonomous_movement/autonomous_movement.md)