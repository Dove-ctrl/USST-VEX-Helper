## 全局定位系统
轮式机器人的全局定位系统，是其进行自主移动的核心模块之一，负责在当前环境中实时、准确地估计自身在全局坐标系下的位姿（位置与朝向）。通过全局定位，机器人可以在环境中提高运动精度、鲁棒性。
事实上，全局定位系统是非常复杂的一个系统，可能集成多种传感器，包含各种复杂算法，超出本教程的范围，因此我们就只介绍比赛中常用的一种方法，也是较为可靠和稳定的方法。

***

### 符号定义

- vₓᴮ ：编码器测得向右的线速度（m/s）
- vᵧᴮ ：编码器测得向前的线速度（m/s）
- ψ ：IMU 输出，顺时针为正，范围 ±π
- ω_z ：IMU 输出的 yaw 角速度，顺时针为正
- 车体坐标系 {B}：x 轴向右，y 轴向前
- 世界坐标系 {W}：xᴡ 东、yᴡ 北
- yaw 角 ψ：定义为车体 y 轴（前进方向）与 world y 轴（北）之间的顺时针夹角，ψ > 0 表示顺时针旋转。

***

### 坐标变换
旋转矩阵：
Rᴡᴮ(ψ) = [ cosψ   sinψ]   ← world 下观察车体 x 轴
[−sinψ   cosψ]   ← world 下观察车体 y 轴

把 {B} 系速度 [vₓᴮ, vᵧᴮ]ᵀ 投影到 {W} 系：
[vₓᴡ]   [cosψ   sinψ][vₓᴮ]
[vᵧᴡ] = [−sinψ  cosψ][vᵧᴮ]

即：
vₓᴡ = vₓᴮ cosψ + vᵧᴮ sinψ
vᵧᴡ = −vₓᴮ sinψ + vᵧᴮ cosψ ----------(1′)

***

### 更新状态
状态 x_k = [xᴡ, yᴡ, ψ]ᵀ
输入 u_k = [vₓᴮ, vᵧᴮ, ω_z]ᵀ
x_{k+1} = x_k + vₓᴡ Δt
y_{k+1} = y_k + vᵧᴡ Δt
ψ_{k+1} = ψ_k + ω_z Δt

把 (1′) 代入得：
x_{k+1} = x_k + [vₓᴮ cosψ_k + vᵧᴮ sinψ_k]Δt
y_{k+1} = y_k + [−vₓᴮ sinψ_k + vᵧᴮ cosψ_k]Δt
ψ_{k+1} = ψ_k + ω_z Δt

***
#### :door: [回到轮式机器人自主移动](/programming/autonomous_movement/autonomous_movement.md)